---
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { siteConfig } from '../../config';
import '../../styles/global.css';

const projects = siteConfig.projects ?? [];
---
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={siteConfig.description} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <title>Projects â€” {siteConfig.name} - {siteConfig.title}</title>
  </head>

  <!-- Use bg-page so theme variables from theme.css apply here -->
  <body class="bg-page">
    <Header />

    <section>
      <main class="max-w-6xl mx-auto px-6 py-12 pt-28 pb-24">
        <h1 class="mb-6 text-3xl" style="font-family: var(--heading-font); font-weight:600; color: rgba(var(--text-color),1);">
          Projects
        </h1>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
          {projects.map((p) => {
            const slug = p.slug ?? p.name.toLowerCase().replace(/\s+/g,'-');
            const banner = `/projects/${slug}.jpg`;
            return (
              <a href={`/projects/${slug}`} class="block rounded-lg overflow-hidden border transition-shadow duration-200 card-surface hover:shadow-lg" key={p.slug ?? p.name}>
                <div class="h-40 sm:h-44 relative">
                  <img
                    src={banner}
                    loading="lazy"
                    alt={`${p.name} banner`}
                    class="w-full h-full object-cover bg-gray-100"
                    onerror="this.style.filter='grayscale(40%)'; this.src='/assets/projects/placeholder.jpg'"
                  />
                </div>

                <div class="p-4">
                  <div class="flex items-start justify-between gap-4">
                    <div class="flex-1">
                      <div class="text-lg leading-tight" style="font-family: var(--heading-font); font-weight:400; color: rgba(var(--text-color),1)">
                        {p.name}
                      </div>
                      <p class="mt-2 text-sm text-muted" style="font-family: var(--body-font);">
                        {p.description ? p.description.slice(0,170) : ''}
                      </p>
                    </div>

                    <div class="text-xs text-muted self-start" style="font-family: var(--body-font);">
                      {p.date ?? ''}
                    </div>
                  </div>

                  {p.skills && p.skills.length > 0 && (
                    <div class="mt-3 flex flex-wrap gap-2">
                      {p.skills.map(s => (
                        <span
                          class="px-2.5 py-1 rounded-md bg-gray-900 text-white text-xs sm:text-sm font-medium"
                          style="font-family: var(--body-font);"
                          key={s}
                        >
                          {s}
                        </span>
                      ))}
                    </div>
                  )}
                </div>
              </a>
            );
          })}
        </div>
      </main>
    </section>

    <Footer />
  </body>
</html>

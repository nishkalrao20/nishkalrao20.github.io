---
---
<button id="themeToggle" aria-label="Toggle theme" aria-pressed="false">
  <!-- Sun Icon -->
  <svg
    class="icon-sun"
    xmlns="http://www.w3.org/2000/svg"
    width="32"
    height="32"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
    aria-hidden="true"
  >
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
  </svg>

  <!-- Moon Icon with Cloud -->
  <svg
    class="icon-moon"
    xmlns="http://www.w3.org/2000/svg"
    width="32"
    height="32"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
    aria-hidden="true"
  >
    <path
      d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
    ></path>
    <g class="moon-cloud">
      <ellipse cx="17" cy="17" rx="4" ry="2" fill="currentColor" opacity="0.3"></ellipse>
    </g>
  </svg>
</button>

<style>
  button {
    border: none;
    background: none;
    cursor: pointer;
    padding: 4px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  svg {
    width: 28px;
    height: 28px;
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  /* Sun rotates */
  .icon-sun {
    animation: spin 12s linear infinite;
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  /* Cloud drift on moon */
  .moon-cloud {
    animation: drift 4s ease-in-out infinite;
  }

  @keyframes drift {
    0% {
      transform: translateX(0);
    }
    50% {
      transform: translateX(2px);
    }
    100% {
      transform: translateX(0);
    }
  }

  /* Toggle visibility */
  .icon-moon {
    display: none;
  }

  :global(.dark) .icon-sun {
    display: none;
  }

  :global(.dark) .icon-moon {
    display: block;
  }
</style>

<script is:inline>
  (function () {
    const btn = document.getElementById('themeToggle');
    if (!btn) return;

    try {
      const saved = localStorage.getItem('theme');
      if (saved === 'dark') document.documentElement.classList.add('dark');
      else if (saved === 'light') document.documentElement.classList.remove('dark');
    } catch (e) {}

    const reflect = () => {
      const isDark = document.documentElement.classList.contains('dark');
      btn.setAttribute('aria-pressed', isDark ? 'true' : 'false');
    };

    btn.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      const isDark = document.documentElement.classList.contains('dark');
      try {
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
      } catch (e) {}
      reflect();
    });

    reflect();
  })();
</script>
